<template>

    <div class="flex items-center justify-between pe-4 py-2 bg-white shadow-lg sticky top-0">
        <!-- Logo + School Info -->
        <div class="flex items-center space-x-3">
            <img src="@/assets/ccis-logo.jpg" class="h-14 w-14 md:h-16 md:w-16 object-contain" alt="CCIS Logo" />
            <img src="@/assets/asscat-logo.jpg" class="h-14 w-14 md:h-16 md:w-16 object-contain" alt="ASSCAT Logo" />
            <div class="flex flex-col leading-tight">
                <h1 class="text-green-700 font-bold text-sm sm:text-sm">
                    Agusan del Sur State College of Agriculture and Technology
                </h1>
                <p class="text-gray-600 text-xs sm:text-sm">College of Computing and Information Sciences</p>
            </div>
        </div>
        <!-- ðŸ”” Notification icon with badge -->
        <a href="#" class="uk-icon-link bell-icon" @click="toggleModal()">
            <!--  <img src="/icons/navbar/notification.svg" alt="" /> -->
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="notification-icon">
                <path
                    d="M0 0 C1.19367188 -0.01675781 2.38734375 -0.03351562 3.6171875 -0.05078125 C9.96570516 0.6066933 14.06990363 3.5104122 18.125 8.3125 C22.9081332 15.64488551 22.6016268 22.23554723 22.375 30.8125 C22.35695313 32.111875 22.33890625 33.41125 22.3203125 34.75 C22.27342615 37.93827151 22.20780893 41.124993 22.125 44.3125 C22.69275146 44.36510986 23.26050293 44.41771973 23.84545898 44.47192383 C59.22509225 48.02946657 93.18959242 68.87024935 115.875 95.6875 C138.5054928 124.69987575 150.38806689 157.68327896 150.42996025 194.52211189 C150.43369769 197.17133189 150.45062178 199.82020124 150.47071838 202.46934509 C150.52541874 209.99145898 150.55659516 217.51362257 150.58129883 225.03588867 C150.73109329 266.45620606 153.75443703 305.75495443 181.125 339.3125 C181.59019043 339.89290039 182.05538086 340.47330078 182.53466797 341.07128906 C187.78365954 347.57772366 193.23152179 353.58857826 199.5 359.125 C207.855028 366.5233352 213.42501481 374.53488673 214.44140625 385.828125 C214.80196924 397.31961652 212.64032914 406.35183121 205.16796875 415.2421875 C196.91901524 423.60154765 187.90129071 427.36443559 176.2092905 427.69281673 C173.50565278 427.71053231 170.80507394 427.71240584 168.10169983 427.70018005 C166.59122795 427.70435854 165.0807592 427.70983887 163.57029623 427.71649987 C159.44108728 427.73090558 155.31207876 427.72672509 151.18285906 427.71933305 C146.72127785 427.71459161 142.25973939 427.72711982 137.798172 427.73735046 C129.06614015 427.75452433 120.33418031 427.75538145 111.60213596 427.75013756 C104.5033955 427.74609221 97.40467627 427.74754375 90.30593681 427.75288582 C89.29468545 427.75363424 88.28343409 427.75438266 87.24153874 427.75515376 C85.18703512 427.75668528 83.13253151 427.75822362 81.0780279 427.75976873 C61.82260461 427.77348852 42.56722199 427.76805961 23.31179964 427.75658352 C5.70500811 427.74665038 -11.90167834 427.75959414 -29.50845366 427.78351771 C-47.59920282 427.8079132 -65.68990304 427.81751555 -83.78066832 427.81086498 C-93.93244805 427.80737394 -104.08414696 427.80959737 -114.23591423 427.82711601 C-122.8772431 427.84184354 -131.51843423 427.84246613 -140.15976041 427.8250451 C-144.56623374 427.81653754 -148.97246106 427.8143796 -153.37892151 427.82969666 C-157.4174986 427.84356087 -161.45561933 427.83875859 -165.49417014 427.81945742 C-166.9503144 427.81570242 -168.40649537 427.81860495 -169.86260688 427.82906907 C-183.36859023 427.91917927 -193.80535071 425.26981078 -203.55859375 415.65234375 C-212.58284217 405.77292964 -213.59143642 395.36820047 -213.05419922 382.453125 C-212.16571396 371.83972074 -204.89741225 363.83062919 -197.1328125 357.26171875 C-170.32690817 334.1195972 -153.44733261 299.79543762 -150.56600952 264.53074646 C-150.48149136 263.18019019 -150.40158025 261.82933967 -150.32568359 260.47827148 C-150.26263314 259.3741059 -150.26263314 259.3741059 -150.19830894 258.24763393 C-149.80393046 250.82954942 -149.70985056 243.41759995 -149.67576981 235.99037361 C-149.66364492 233.57704087 -149.64412638 231.16386197 -149.62265015 228.75059509 C-149.56209908 221.90287556 -149.50715417 215.05518592 -149.47363281 208.20727539 C-149.45240982 203.97941066 -149.41691817 199.75185383 -149.37287521 195.52416801 C-149.35895919 193.93978989 -149.35004976 192.35535765 -149.34682083 190.77092171 C-149.31367838 176.07869559 -147.7889544 161.49849988 -143.0625 147.5 C-142.80460693 146.71286621 -142.54671387 145.92573242 -142.28100586 145.11474609 C-139.97728698 138.26441603 -137.16404125 131.74974194 -133.875 125.3125 C-133.35292969 124.25933594 -132.83085937 123.20617187 -132.29296875 122.12109375 C-125.13925601 108.19899706 -115.8596219 96.38972896 -104.875 85.3125 C-103.95203125 84.37664062 -103.0290625 83.44078125 -102.078125 82.4765625 C-82.14665744 63.26086588 -49.46244195 44.3125 -20.875 44.3125 C-20.90118408 43.44560547 -20.92736816 42.57871094 -20.9543457 41.68554688 C-21.04011891 38.43528504 -21.10251444 35.18560445 -21.1496582 31.93457031 C-21.17463412 30.53398531 -21.20862817 29.13352839 -21.25219727 27.73339844 C-21.71083766 12.60366126 -21.71083766 12.60366126 -15.875 6.3125 C-10.73818103 1.55154583 -7.01294988 0.02262242 0 0 Z "
                    fill="#000000" transform="translate(255.875,-0.3125)" />
                <path
                    d="M0 0 C52.14 0 104.28 0 158 0 C155.26328696 13.68356519 150.82895104 24.21629965 142 35 C141.32195312 35.85335937 140.64390625 36.70671875 139.9453125 37.5859375 C128.43350615 51.29046887 109.92827522 62.02170756 92 64 C68.03784297 65.53412352 45.85189046 62.14438525 27.15625 45.97265625 C26.4446875 45.32167969 25.733125 44.67070312 25 44 C24.3296875 43.42121094 23.659375 42.84242188 22.96875 42.24609375 C10.89360825 31.1532552 3.19044398 15.95221989 0 0 Z "
                    fill="#000000" transform="translate(177,448)" />
            </svg>
            <span class="notification-badge" v-if="notificationCount">{{ notificationCount }}</span>
        </a>
    </div>
    <NotificationList v-if="showModal" @toggleThisModal="toggleModal()" @refresh="getNotifications()" />

</template>

<script setup>
import { fetchAllNotifications, fetchUnreadNotifications } from '@/services/apiService';
import { computed, onMounted, ref } from 'vue';
import NotificationList from './NotificationList.vue';

const notifications = ref([]);
const notificationCount = computed(() => notifications.value.length);
const showModal = ref(false);

const toggleModal = () => {
    showModal.value = !showModal.value
}

const getNotifications = async () => {
    try {
        const response = await fetchUnreadNotifications()
        notifications.value = response
    } catch (error) {
        console.error('Error fetching curriculums:', error)
    }
}

onMounted(() => {
    getNotifications();
})

</script>